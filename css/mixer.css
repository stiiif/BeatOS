/* css/mixer.css */

:root {
    /* Configuration Variables */
    --track-width: 42px; /* Default max width */
    --knob-ratio: 0.62;  /* Knob size relative to strip width */
    --strip-gap: 2px;
    --knob-gap: 8px;     /* Vertical gap between controls */
}

/* Mixer Container */
.mixer-container {
    display: flex;
    flex-direction: row; 
    flex-wrap: nowrap;   
    height: 100%;
    width: 100%;
    background-color: #121212;
    overflow-x: auto;    
    overflow-y: hidden;
    padding: 8px;
    gap: var(--strip-gap);
    align-items: flex-start;
}

/* --- STRIPS --- */

/* Base Strip Styling */
.mixer-strip {
    display: flex;
    flex-direction: column;
    height: 100%;
    background-color: #1e1e1e;
    border: 1px solid #333;
    border-radius: 3px;
    box-shadow: 1px 0 3px rgba(0,0,0,0.3);
    position: relative;
    flex-shrink: 0;
}

/* 1. Label Strip (Fixed width, aligns with tracks) */
.mixer-strip.label-strip {
    width: 50px; /* Fixed width for text readability */
    background-color: #151515;
    border: none;
    z-index: 5;
}

/* 2. Track Strip (Dynamic Width) */
.mixer-strip.track-strip {
    width: var(--track-width);
    min-width: 18px; /* Hard limit from requirements */
}

/* 3. Group Strip (Fixed width) */
.mixer-strip.group-strip {
    background-color: #252525;
    border-color: #444;
    width: 50px;
}

/* 4. Master Strip (Fixed width) */
.mixer-strip.master-strip {
    background-color: #1a1515;
    border-color: #552222;
    width: 60px;
    margin-left: 6px; 
    box-shadow: -2px 0 5px rgba(0,0,0,0.5);
}

/* --- HEADER ALIGNMENT --- */
.strip-header {
    height: 24px; /* Enforce fixed height for alignment */
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #2a2a2a;
    border-bottom: 1px solid #000;
    flex-shrink: 0;
    overflow: hidden;
}

.strip-num, .strip-name {
    font-size: 0.55rem;
    font-weight: bold;
    color: #ccc;
    white-space: nowrap;
}

/* --- CONTROLS AREA --- */
.strip-controls {
    flex: 1;
    overflow-y: auto; 
    overflow-x: hidden;
    padding: 6px 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--knob-gap); /* Consistent gap is crucial for alignment */
    background: linear-gradient(180deg, #1e1e1e 0%, #151515 100%);
}

/* Scrollbar hiding for cleaner look */
.strip-controls::-webkit-scrollbar { width: 0px; background: transparent; }

/* --- KNOB & LABEL COMPONENTS --- */

/* The container for both Knobs (Tracks) and Text (Labels) */
.mixer-pot {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1px;
    width: 100%;
    
    /* CRITICAL: Height is derived from width to ensure 
       aspect ratio is maintained as width changes.
       This ensures the vertical rhythm matches perfectly.
    */
    height: calc(var(--track-width) * var(--knob-ratio) + 12px); /* +12px for label space/padding */
    min-height: 20px;
    flex-shrink: 0; /* Prevent squashing */
}

/* Text inside the label strip */
.mixer-pot.label-item label {
    font-size: 0.55rem;
    color: #888;
    font-weight: bold;
    text-transform: uppercase;
    text-align: right;
    width: 100%;
    padding-right: 4px;
}

/* Labels inside Track Strips (Hidden if too small) */
.mixer-pot.track-item label {
    display: none; /* Hide internal labels to save space, rely on Label Strip */
}

/* The Rotary Knob Visual */
.knob-outer {
    /* Dynamic size based on strip width */
    width: calc(var(--track-width) * var(--knob-ratio));
    height: calc(var(--track-width) * var(--knob-ratio));
    
    /* Clamps to keep it sane */
    max-width: 28px;
    max-height: 28px;
    min-width: 14px;
    min-height: 14px;

    border-radius: 50%;
    background: conic-gradient(from 180deg, #333 0%, #111 100%);
    border: 1px solid #000;
    box-shadow: 0 1px 2px rgba(0,0,0,0.5);
    position: relative;
    cursor: ns-resize;
}

.knob-inner {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    position: absolute;
    top: 0; left: 0;
}

/* The indicator line - Use percentages to scale automatically */
.knob-line {
    width: 10%;
    height: 35%;
    background: #ccc;
    position: absolute;
    top: 15%; 
    left: 45%;
    border-radius: 1px;
    box-shadow: 0 0 2px rgba(255,255,255,0.3);
}

/* Knob Colors */
.knob-color-red .knob-line { background: #ef4444; box-shadow: 0 0 3px #ef4444; }
.knob-color-blue .knob-line { background: #3b82f6; box-shadow: 0 0 3px #3b82f6; }
.knob-color-green .knob-line { background: #10b981; box-shadow: 0 0 3px #10b981; }
.knob-color-yellow .knob-line { background: #eab308; box-shadow: 0 0 3px #eab308; }
.knob-color-purple .knob-line { background: #d946ef; box-shadow: 0 0 3px #d946ef; }

/* Tooltip */
.knob-value-tip {
    font-size: 0.6rem;
    color: #10b981;
    position: absolute;
    top: -15px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.9);
    padding: 1px 3px;
    border-radius: 2px;
    opacity: 0;
    pointer-events: none;
    z-index: 100;
    white-space: nowrap;
}
.knob-outer:hover .knob-value-tip, .mixer-pot.dragging .knob-value-tip { opacity: 1; }


/* --- FADER SECTION --- */
.strip-fader-section {
    height: 140px; 
    width: 100%;
    background: #111;
    border-top: 1px solid #000;
    padding: 6px 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    flex-shrink: 0;
}

.strip-btn-row {
    display: flex;
    width: 90%;
    gap: 1px;
    height: 20px; /* Fixed height for buttons */
}

.mixer-btn {
    flex: 1;
    font-size: 0.5rem; /* Tiny text */
    padding: 0;
    background: #333;
    color: #666;
    border: 1px solid #000;
    border-radius: 2px;
    cursor: pointer;
    display: flex; 
    align-items: center; 
    justify-content: center;
}
.mixer-btn.mute.active { background: #ef4444; color: white; }
.mixer-btn.solo.active { background: #eab308; color: black; }

/* Width Slider (In Label Strip Header) */
.width-slider {
    width: 40px;
    height: 4px;
    -webkit-appearance: none;
    background: #444;
    border-radius: 2px;
    cursor: ew-resize;
}
.width-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #888;
}

/* EQ Section Container */
.eq-section {
    width: 96%;
    background: #111;
    border: 1px solid #333;
    border-radius: 2px;
    padding: 4px 1px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    margin-bottom: 4px;
}